
CONFIGURE_FILE("${CMAKE_CURRENT_SOURCE_DIR}/${SANDBOX_NAME}.pc.in"
               "${CMAKE_CURRENT_BINARY_DIR}/${SANDBOX_NAME}.pc"
               @ONLY)
INSTALL(FILES "${CMAKE_CURRENT_BINARY_DIR}/${SANDBOX_NAME}.pc"
        DESTINATION lib/pkgconfig)

INCLUDE_DIRECTORIES(BEFORE ${CMAKE_CURRENT_BINARY_DIR} "${CMAKE_CURRENT_BINARY_DIR}/../stable")

PROTOBUF_GENERATE(CPP CPP_SANDBOX_SOURCES CPP_SANDBOX_HEADERS
                  EXPORT_MACRO RST_EXPORT
                  PROTOFILES ${SANDBOX_PROTOS}
                  PROTOROOT ${SANDBOX_ROOT}
                  INCLUDES ${STABLE_ROOT}
                  OUTPATH ${CMAKE_CURRENT_BINARY_DIR})

ADD_LIBRARY(${SANDBOX_NAME} SHARED ${CPP_SANDBOX_SOURCES} ${CPP_SANDBOX_HEADERS})
TARGET_LINK_LIBRARIES(${SANDBOX_NAME} ${PROTOBUF_LIBRARIES})
INSTALL(TARGETS ${SANDBOX_NAME}
        EXPORT RSTSandboxDepends
        ARCHIVE DESTINATION lib
        LIBRARY DESTINATION lib
        RUNTIME DESTINATION bin)

CONFIGURE_FILE(RSTSandboxConfig.cmake.in "${CMAKE_CURRENT_BINARY_DIR}/RSTSandboxConfig.cmake" @ONLY)
INSTALL(FILES "${CMAKE_CURRENT_BINARY_DIR}/RSTSandboxConfig.cmake" DESTINATION share/rstsandbox)
EXPORT(TARGETS ${SANDBOX_NAME} FILE "${CMAKE_BINARY_DIR}/RSTSandboxDepends.cmake")
INSTALL(EXPORT RSTSandboxDepends
        DESTINATION "share/rstsandbox")

INSTALL_FILES_RECURSIVE("include/rstsandbox/" CPP_SANDBOX_HEADERS)
